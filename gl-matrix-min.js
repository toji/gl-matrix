// gl-matrix 1.3.0 - https://github.com/toji/gl-matrix/blob/master/LICENSE.md
(function(r,D){"object"===typeof exports?module.exports=D(global):"function"===typeof define&&define.amd?define([],function(){return D(r)}):D(r)})(this,function(r){function D(a){return t=a}function L(){return t="undefined"!==typeof Float32Array?Float32Array:Array}var E={};(function(){if("undefined"!=typeof Float32Array){var a=new Float32Array(1),b=new Int32Array(a.buffer);E.invsqrt=function(c){a[0]=c;b[0]=1597463007-(b[0]>>1);var d=a[0];return d*(1.5-0.5*c*d*d)}}else E.invsqrt=function(a){return 1/
Math.sqrt(a)}})();var t=null;L();var n={create:function(a){var b=new t(3);a?(b[0]=a[0],b[1]=a[1],b[2]=a[2]):b[0]=b[1]=b[2]=0;return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},add:function(a,b,c){if(!c||a===c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c},subtract:function(a,b,c){if(!c||a===c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c},multiply:function(a,b,c){if(!c||a===c)return a[0]*=
b[0],a[1]*=b[1],a[2]*=b[2],a;c[0]=a[0]*b[0];c[1]=a[1]*b[1];c[2]=a[2]*b[2];return c},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b},scale:function(a,b,c){if(!c||a===c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c},normalize:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=Math.sqrt(c*c+d*d+e*e);if(!f)return b[0]=0,b[1]=0,b[2]=0,b;if(1===f)return b[0]=c,b[1]=d,b[2]=e,b;f=1/f;b[0]=c*f;b[1]=d*f;b[2]=e*f;return b},cross:function(a,b,c){c||(c=a);
var d=a[0],e=a[1],a=a[2],f=b[0],g=b[1],b=b[2];c[0]=e*b-a*g;c[1]=a*f-d*b;c[2]=d*g-e*f;return c},length:function(a){var b=a[0],c=a[1],a=a[2];return Math.sqrt(b*b+c*c+a*a)},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},direction:function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1],a=a[2]-b[2],b=Math.sqrt(d*d+e*e+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=d*b;c[1]=e*b;c[2]=a*b;return c},lerp:function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-
a[2]);return d},dist:function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)}},M=null,s=new t(4);n.unproject=function(a,b,c,d,e){e||(e=a);M||(M=p.create());var f=M;s[0]=2*(a[0]-d[0])/d[2]-1;s[1]=2*(a[1]-d[1])/d[3]-1;s[2]=2*a[2]-1;s[3]=1;p.multiply(c,b,f);if(!p.inverse(f))return null;p.multiplyVec4(f,s);if(0===s[3])return null;e[0]=s[0]/s[3];e[1]=s[1]/s[3];e[2]=s[2]/s[3];return e};var N=n.create([1,0,0]),O=n.create([0,1,0]),P=n.create([0,0,1]);n.rotationTo=function(a,b,
c){c||(c=h.create());var d=n.dot(a,b),e=n.create();if(1<=d)h.set(Q,c);else if(-0.999999>d)n.cross(N,a,e),1.0E-6>e.length&&n.cross(O,a,e),1.0E-6>e.length&&n.cross(P,a,e),n.normalize(e),h.fromAxisAngle(e,Math.PI,c);else{var d=Math.sqrt(2*(1+d)),f=1/d;n.cross(a,b,e);c[0]=e[0]*f;c[1]=e[1]*f;c[2]=e[2]*f;c[3]=0.5*d;h.normalize(c)}1<c[3]?c[3]=1:-1>c[3]&&(c[3]=-1);return c};n.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};var C={create:function(a){var b=new t(9);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],
b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8]);return b},multiplyVec3:function(a,b,c){c||(c=b);var d=b[0],e=b[1],b=b[2];c[0]=d*a[0]+e*a[3]+b*a[6];c[1]=d*a[1]+e*a[4]+b*a[7];c[2]=d*a[2]+e*a[5]+b*a[8];return c},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},identity:function(a){a||(a=C.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(!b||a===b){var c=a[1],
d=a[2],e=a[5];a[1]=a[3];a[2]=a[6];a[3]=c;a[5]=a[7];a[6]=d;a[7]=e;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b},toMat4:function(a,b){b||(b=p.create());b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},p={create:function(a){var b=
new t(16);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},identity:function(a){a||(a=p.create());a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=
0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(!b||a===b){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],k=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=c;a[6]=a[9];a[7]=a[13];a[8]=d;a[9]=f;a[11]=a[14];a[12]=e;a[13]=g;a[14]=k;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b},determinant:function(a){var b=a[0],c=a[1],d=a[2],e=a[3],
f=a[4],g=a[5],k=a[6],j=a[7],i=a[8],m=a[9],l=a[10],F=a[11],q=a[12],o=a[13],h=a[14],a=a[15];return q*m*k*e-i*o*k*e-q*g*l*e+f*o*l*e+i*g*h*e-f*m*h*e-q*m*d*j+i*o*d*j+q*c*l*j-b*o*l*j-i*c*h*j+b*m*h*j+q*g*d*F-f*o*d*F-q*c*k*F+b*o*k*F+f*c*h*F-b*g*h*F-i*g*d*a+f*m*d*a+i*c*k*a-b*m*k*a-f*c*l*a+b*g*l*a},inverse:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],k=a[5],j=a[6],i=a[7],m=a[8],l=a[9],h=a[10],q=a[11],o=a[12],G=a[13],H=a[14],p=a[15],n=c*k-d*g,I=c*j-e*g,v=c*i-f*g,w=d*j-e*k,x=d*i-f*k,y=e*i-f*
j,z=m*G-l*o,A=m*H-h*o,B=m*p-q*o,r=l*H-h*G,s=l*p-q*G,t=h*p-q*H,u=n*t-I*s+v*r+w*B-x*A+y*z;if(!u)return null;u=1/u;b[0]=(k*t-j*s+i*r)*u;b[1]=(-d*t+e*s-f*r)*u;b[2]=(G*y-H*x+p*w)*u;b[3]=(-l*y+h*x-q*w)*u;b[4]=(-g*t+j*B-i*A)*u;b[5]=(c*t-e*B+f*A)*u;b[6]=(-o*y+H*v-p*I)*u;b[7]=(m*y-h*v+q*I)*u;b[8]=(g*s-k*B+i*z)*u;b[9]=(-c*s+d*B-f*z)*u;b[10]=(o*x-G*v+p*n)*u;b[11]=(-m*x+l*v-q*n)*u;b[12]=(-g*r+k*A-j*z)*u;b[13]=(c*r-d*A+e*z)*u;b[14]=(-o*w+G*I-H*n)*u;b[15]=(m*w-l*I+h*n)*u;return b},toRotationMat:function(a,b){b||
(b=p.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},toMat3:function(a,b){b||(b=C.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b},toInverseMat3:function(a,b){var c=a[0],d=a[1],e=a[2],f=a[4],g=a[5],k=a[6],j=a[8],i=a[9],m=a[10],l=m*g-k*i,h=-m*f+k*j,q=i*f-g*j,o=c*l+d*h+e*q;if(!o)return null;o=1/o;b||(b=C.create());
b[0]=l*o;b[1]=(-m*d+e*i)*o;b[2]=(k*d-e*g)*o;b[3]=h*o;b[4]=(m*c-e*j)*o;b[5]=(-k*c+e*f)*o;b[6]=q*o;b[7]=(-i*c+d*j)*o;b[8]=(g*c-d*f)*o;return b},multiply:function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],k=a[4],j=a[5],i=a[6],m=a[7],l=a[8],h=a[9],q=a[10],o=a[11],p=a[12],n=a[13],r=a[14],a=a[15],s=b[0],t=b[1],v=b[2],w=b[3],x=b[4],y=b[5],z=b[6],A=b[7],B=b[8],C=b[9],D=b[10],E=b[11],u=b[12],J=b[13],K=b[14],b=b[15];c[0]=s*d+t*k+v*l+w*p;c[1]=s*e+t*j+v*h+w*n;c[2]=s*f+t*i+v*q+w*r;c[3]=s*g+t*m+v*o+w*a;c[4]=
x*d+y*k+z*l+A*p;c[5]=x*e+y*j+z*h+A*n;c[6]=x*f+y*i+z*q+A*r;c[7]=x*g+y*m+z*o+A*a;c[8]=B*d+C*k+D*l+E*p;c[9]=B*e+C*j+D*h+E*n;c[10]=B*f+C*i+D*q+E*r;c[11]=B*g+C*m+D*o+E*a;c[12]=u*d+J*k+K*l+b*p;c[13]=u*e+J*j+K*h+b*n;c[14]=u*f+J*i+K*q+b*r;c[15]=u*g+J*m+K*o+b*a;return c},multiplyVec3:function(a,b,c){c||(c=b);var d=b[0],e=b[1],b=b[2];c[0]=a[0]*d+a[4]*e+a[8]*b+a[12];c[1]=a[1]*d+a[5]*e+a[9]*b+a[13];c[2]=a[2]*d+a[6]*e+a[10]*b+a[14];return c},multiplyVec4:function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2],b=b[3];
c[0]=a[0]*d+a[4]*e+a[8]*f+a[12]*b;c[1]=a[1]*d+a[5]*e+a[9]*f+a[13]*b;c[2]=a[2]*d+a[6]*e+a[10]*f+a[14]*b;c[3]=a[3]*d+a[7]*e+a[11]*f+a[15]*b;return c},translate:function(a,b,c){var d=b[0],e=b[1],b=b[2],f,g,k,j,i,m,l,h,q,o,p,n;if(!c||a===c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;f=a[0];g=a[1];k=a[2];j=a[3];i=a[4];m=a[5];l=a[6];h=a[7];q=a[8];o=a[9];p=a[10];n=a[11];c[0]=f;c[1]=g;c[2]=k;c[3]=j;c[4]=i;c[5]=
m;c[6]=l;c[7]=h;c[8]=q;c[9]=o;c[10]=p;c[11]=n;c[12]=f*d+i*e+q*b+a[12];c[13]=g*d+m*e+o*b+a[13];c[14]=k*d+l*e+p*b+a[14];c[15]=j*d+h*e+n*b+a[15];return c},scale:function(a,b,c){var d=b[0],e=b[1],b=b[2];if(!c||a===c)return a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*e;c[5]=a[5]*e;c[6]=a[6]*e;c[7]=a[7]*e;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];
c[15]=a[15];return c},rotate:function(a,b,c,d){var e=c[0],f=c[1],c=c[2],g=Math.sqrt(e*e+f*f+c*c),k,j,i,m,l,h,q,o,p,n,r,s,t,v,w,x,y,z,A,B;if(!g)return null;1!==g&&(g=1/g,e*=g,f*=g,c*=g);k=Math.sin(b);j=Math.cos(b);i=1-j;b=a[0];g=a[1];m=a[2];l=a[3];h=a[4];q=a[5];o=a[6];p=a[7];n=a[8];r=a[9];s=a[10];t=a[11];v=e*e*i+j;w=f*e*i+c*k;x=c*e*i-f*k;y=e*f*i-c*k;z=f*f*i+j;A=c*f*i+e*k;B=e*c*i+f*k;e=f*c*i-e*k;f=c*c*i+j;d?a!==d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=b*v+h*w+n*x;d[1]=g*v+q*w+r*
x;d[2]=m*v+o*w+s*x;d[3]=l*v+p*w+t*x;d[4]=b*y+h*z+n*A;d[5]=g*y+q*z+r*A;d[6]=m*y+o*z+s*A;d[7]=l*y+p*z+t*A;d[8]=b*B+h*e+n*f;d[9]=g*B+q*e+r*f;d[10]=m*B+o*e+s*f;d[11]=l*B+p*e+t*f;return d},rotateX:function(a,b,c){var d=Math.sin(b),b=Math.cos(b),e=a[4],f=a[5],g=a[6],k=a[7],j=a[8],i=a[9],m=a[10],h=a[11];c?a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[4]=e*b+j*d;c[5]=f*b+i*d;c[6]=g*b+m*d;c[7]=k*b+h*d;c[8]=e*-d+j*b;c[9]=f*-d+i*b;c[10]=g*-d+m*b;c[11]=
k*-d+h*b;return c},rotateY:function(a,b,c){var d=Math.sin(b),b=Math.cos(b),e=a[0],f=a[1],g=a[2],k=a[3],j=a[8],i=a[9],m=a[10],h=a[11];c?a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+j*-d;c[1]=f*b+i*-d;c[2]=g*b+m*-d;c[3]=k*b+h*-d;c[8]=e*d+j*b;c[9]=f*d+i*b;c[10]=g*d+m*b;c[11]=k*d+h*b;return c},rotateZ:function(a,b,c){var d=Math.sin(b),b=Math.cos(b),e=a[0],f=a[1],g=a[2],k=a[3],j=a[4],i=a[5],h=a[6],l=a[7];c?a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=
a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+j*d;c[1]=f*b+i*d;c[2]=g*b+h*d;c[3]=k*b+l*d;c[4]=e*-d+j*b;c[5]=f*-d+i*b;c[6]=g*-d+h*b;c[7]=k*-d+l*b;return c},frustum:function(a,b,c,d,e,f,g){g||(g=p.create());var k=b-a,j=d-c,i=f-e;g[0]=2*e/k;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=2*e/j;g[6]=0;g[7]=0;g[8]=(b+a)/k;g[9]=(d+c)/j;g[10]=-(f+e)/i;g[11]=-1;g[12]=0;g[13]=0;g[14]=-(2*f*e)/i;g[15]=0;return g},perspective:function(a,b,c,d,e){a=c*Math.tan(a*Math.PI/360);b*=a;return p.frustum(-b,
b,-a,a,c,d,e)},ortho:function(a,b,c,d,e,f,g){g||(g=p.create());var k=b-a,j=d-c,i=f-e;g[0]=2/k;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=2/j;g[6]=0;g[7]=0;g[8]=0;g[9]=0;g[10]=-2/i;g[11]=0;g[12]=-(a+b)/k;g[13]=-(d+c)/j;g[14]=-(f+e)/i;g[15]=1;return g},lookAt:function(a,b,c,d){d||(d=p.create());var e,f,g,k,j,i,h,l,n=a[0],q=a[1],a=a[2];g=c[0];k=c[1];f=c[2];h=b[0];c=b[1];e=b[2];if(n===h&&q===c&&a===e)return p.identity(d);b=n-h;c=q-c;h=a-e;l=1/Math.sqrt(b*b+c*c+h*h);b*=l;c*=l;h*=l;e=k*h-f*c;f=f*b-g*h;g=g*c-k*b;
(l=Math.sqrt(e*e+f*f+g*g))?(l=1/l,e*=l,f*=l,g*=l):g=f=e=0;k=c*g-h*f;j=h*e-b*g;i=b*f-c*e;(l=Math.sqrt(k*k+j*j+i*i))?(l=1/l,k*=l,j*=l,i*=l):i=j=k=0;d[0]=e;d[1]=k;d[2]=b;d[3]=0;d[4]=f;d[5]=j;d[6]=c;d[7]=0;d[8]=g;d[9]=i;d[10]=h;d[11]=0;d[12]=-(e*n+f*q+g*a);d[13]=-(k*n+j*q+i*a);d[14]=-(b*n+c*q+h*a);d[15]=1;return d},fromRotationTranslation:function(a,b,c){c||(c=p.create());var d=a[0],e=a[1],f=a[2],g=a[3],k=d+d,h=e+e,i=f+f,a=d*k,m=d*h,d=d*i,l=e*h,e=e*i,f=f*i,k=g*k,h=g*h,g=g*i;c[0]=1-(l+f);c[1]=m+g;c[2]=
d-h;c[3]=0;c[4]=m-g;c[5]=1-(a+f);c[6]=e+k;c[7]=0;c[8]=d+h;c[9]=e-k;c[10]=1-(a+l);c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];c[15]=1;return c},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}},h={create:function(a){var b=new t(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},identity:function(a){a||
(a=h.create());a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}},Q=h.identity();h.calculateW=function(a,b){var c=a[0],d=a[1],e=a[2];if(!b||a===b)return a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a;b[0]=c;b[1]=d;b[2]=e;b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b};h.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};h.inverse=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],c=(c=c*c+d*d+e*e+f*f)?1/c:0;if(!b||a===b)return a[0]*=-c,a[1]*=-c,a[2]*=-c,a[3]*=c,a;b[0]=-a[0]*c;b[1]=-a[1]*c;b[2]=-a[2]*
c;b[3]=a[3]*c;return b};h.conjugate=function(a,b){if(!b||a===b)return a[0]*=-1,a[1]*=-1,a[2]*=-1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};h.length=function(a){var b=a[0],c=a[1],d=a[2],a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};h.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=Math.sqrt(c*c+d*d+e*e+f*f);if(0===g)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;g=1/g;b[0]=c*g;b[1]=d*g;b[2]=e*g;b[3]=f*g;return b};h.add=function(a,b,c){if(!c||a===c)return a[0]+=b[0],a[1]+=b[1],a[2]+=
b[2],a[3]+=b[3],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c};h.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],a=a[3],g=b[0],h=b[1],j=b[2],b=b[3];c[0]=d*b+a*g+e*j-f*h;c[1]=e*b+a*h+f*g-d*j;c[2]=f*b+a*j+d*h-e*g;c[3]=a*b-d*g-e*h-f*j;return c};h.multiplyVec3=function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2],b=a[0],g=a[1],h=a[2],a=a[3],j=a*d+g*f-h*e,i=a*e+h*d-b*f,m=a*f+b*e-g*d,d=-b*d-g*e-h*f;c[0]=j*a+d*-b+i*-h-m*-g;c[1]=i*a+d*-g+m*-b-j*-h;c[2]=m*a+d*-h+j*-g-i*-b;return c};
h.scale=function(a,b,c){if(!c||a===c)return a[0]*=b,a[1]*=b,a[2]*=b,a[3]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c};h.toMat3=function(a,b){b||(b=C.create());var c=a[0],d=a[1],e=a[2],f=a[3],g=c+c,h=d+d,j=e+e,i=c*g,m=c*h,c=c*j,l=d*h,d=d*j,e=e*j,g=f*g,h=f*h,f=f*j;b[0]=1-(l+e);b[1]=m+f;b[2]=c-h;b[3]=m-f;b[4]=1-(i+e);b[5]=d+g;b[6]=c+h;b[7]=d-g;b[8]=1-(i+l);return b};h.toMat4=function(a,b){b||(b=p.create());var c=a[0],d=a[1],e=a[2],f=a[3],g=c+c,h=d+d,j=e+e,i=c*g,m=c*h,c=c*j,l=d*h,d=
d*j,e=e*j,g=f*g,h=f*h,f=f*j;b[0]=1-(l+e);b[1]=m+f;b[2]=c-h;b[3]=0;b[4]=m-f;b[5]=1-(i+e);b[6]=d+g;b[7]=0;b[8]=c+h;b[9]=d-g;b[10]=1-(i+l);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};h.slerp=function(a,b,c,d){d||(d=a);var e=a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3],f,g;if(1<=Math.abs(e))return d!==a&&(d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3]),d;f=Math.acos(e);g=Math.sqrt(1-e*e);if(0.001>Math.abs(g))return d[0]=0.5*a[0]+0.5*b[0],d[1]=0.5*a[1]+0.5*b[1],d[2]=0.5*a[2]+0.5*b[2],d[3]=0.5*a[3]+0.5*b[3],
d;e=Math.sin((1-c)*f)/g;c=Math.sin(c*f)/g;d[0]=a[0]*e+b[0]*c;d[1]=a[1]*e+b[1]*c;d[2]=a[2]*e+b[2]*c;d[3]=a[3]*e+b[3]*c;return d};h.fromRotationMatrix=function(a,b){b||(b=h.create());var c=a[0]+a[4]+a[8],d;if(0<c)d=Math.sqrt(c+1),b[3]=0.5*d,d=0.5/d,b[0]=(a[7]-a[5])*d,b[1]=(a[2]-a[6])*d,b[2]=(a[3]-a[1])*d;else{d=h.fromRotationMatrix.s_iNext=h.fromRotationMatrix.s_iNext||[1,2,0];c=0;a[4]>a[0]&&(c=1);a[8]>a[3*c+c]&&(c=2);var e=d[c],f=d[e];d=Math.sqrt(a[3*c+c]-a[3*e+e]-a[3*f+f]+1);b[c]=0.5*d;d=0.5/d;b[3]=
(a[3*f+e]-a[3*e+f])*d;b[e]=(a[3*e+c]+a[3*c+e])*d;b[f]=(a[3*f+c]+a[3*c+f])*d}return b};C.toQuat4=h.fromRotationMatrix;(function(){var a=C.create();h.fromAxes=function(b,c,d,e){a[0]=c[0];a[3]=c[1];a[6]=c[2];a[1]=d[0];a[4]=d[1];a[7]=d[2];a[2]=b[0];a[5]=b[1];a[8]=b[2];return h.fromRotationMatrix(a,e)}})();h.identity=function(a){a||(a=h.create());a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};h.fromAngleAxis=function(a,b,c){c||(c=h.create());var a=0.5*a,d=Math.sin(a);c[3]=Math.cos(a);c[0]=d*b[0];c[1]=d*b[1];c[2]=
d*b[2];return c};h.toAngleAxis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=E.invsqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};h.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};r&&(r.glMatrixArrayType=t,r.MatrixArray=t,r.setMatrixArrayType=D,r.determineMatrixArrayType=L,r.glMath=E,r.vec3=n,r.mat3=C,r.mat4=p,r.quat4=h);return{glMatrixArrayType:t,MatrixArray:t,setMatrixArrayType:D,determineMatrixArrayType:L,
glMath:E,vec3:n,mat3:C,mat4:p,quat4:h}});